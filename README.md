# Amazon Product Crawler API with AI

ì´ í”„ë¡œì íŠ¸ëŠ” **FastAPI**, **LangGraph**, **Playwright**, ê·¸ë¦¬ê³  **AWS Bedrock (Claude 3 Haiku)**ì„ í™œìš©í•˜ì—¬ ì•„ë§ˆì¡´(Amazon) ìƒí’ˆ ì •ë³´ë¥¼ ì§€ëŠ¥ì ìœ¼ë¡œ ìˆ˜ì§‘í•˜ê³  ë¶„ì„í•˜ëŠ” APIì…ë‹ˆë‹¤.

**Claude 3 Haiku** ëª¨ë¸ì„ ì±„íƒí•˜ì—¬ **1íšŒ ìš”ì²­ ë‹¹ ì•½ 5ì› ë¯¸ë§Œ**ì˜ ì´ˆì €ë¹„ìš©ìœ¼ë¡œ ëª¨ë“  ìƒì„¸ ë°ì´í„°ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.

## ğŸš€ ì‹œì‘ ê°€ì´ë“œ (Quick Start)

ì´ í”„ë¡œì íŠ¸ëŠ” `uv` íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ì¡´ì„±ì„ ê´€ë¦¬í•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤.

### 1. ìš”êµ¬ ì‚¬í•­ (Prerequisites)
- **Python 3.11+**
- **uv** (Python íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €)
- **AWS Credentials**: ë¡œì»¬ í™˜ê²½ì— AWS ìê²© ì¦ëª…ì´ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤ (`~/.aws/credentials`). Bedrock ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•˜ë©°, `anthropic.claude-3-haiku-20240307-v1:0` ëª¨ë¸ ì ‘ê·¼ì´ í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

### 2. ì„¤ì¹˜ ë° ì‹¤í–‰ (Installation & Run)

í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë§Œ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤:

```bash
# 1. ì˜ì¡´ì„± ë™ê¸°í™” (ê°€ìƒí™˜ê²½ ìƒì„± ë° íŒ¨í‚¤ì§€ ì„¤ì¹˜)
uv sync

# 2. Playwright ë¸Œë¼ìš°ì € ì„¤ì¹˜ (ìµœì´ˆ 1íšŒ í•„ìš”)
uv run playwright install chromium

# 3. ì„œë²„ ì‹¤í–‰
uv run run.py
```

ì„œë²„ê°€ ì‹¤í–‰ë˜ë©´ `http://127.0.0.1:8000` ì—ì„œ APIê°€ ëŒ€ê¸°í•©ë‹ˆë‹¤.

---

## ğŸ“¡ API ì‚¬ìš©ë²• (Usage)

### ìƒí’ˆ ì •ë³´ ìš”ì²­

**POST** `/api/v1/product/info`

**Request Body:**
```json
{
  "url": "https://www.amazon.com/dp/B00FLYWNYQ" 
}
```

**Response Example:**
```json
{
  "title": "Instant Pot Duo 7-in-1 Electric Pressure Cooker",
  "asin": "B00FLYWNYQ",
  "price": "$99.95",
  "features": [
    "7-in-1 functionality...",
    "Fast cooking..."
  ],
  "specifications": {
    "Brand": "Instant Pot",
    "Capacity": "6 Quarts",
    "Material": "Stainless Steel"
  },
  "product_details": {
    "Manufacturer": "Instant Brands",
    "Item Weight": "11.8 pounds"
  },
  "full_description": "...",
  "availability": "In Stock",
  "usage": {
    "prompt_tokens": 2375,
    "completion_tokens": 2052,
    "total_tokens": 4427
  }
}
```

*   **usage**: Bedrock ëª¨ë¸ì˜ í† í° ì‚¬ìš©ëŸ‰ ì •ë³´ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë¹„ìš©ì„ ì¶”ì í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    *   **ì˜ˆìƒ ë¹„ìš©**: ì•½ 4.5 KRW (ì…ë ¥ 2400ê°œ + ì¶œë ¥ 2000ê°œ ê¸°ì¤€)

---

## ğŸ§  ì•„í‚¤í…ì²˜ ë° ì‘ë™ ì›ë¦¬ (Architecture)

ì´ APIëŠ” **LangGraph**ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ìˆ˜ì§‘ íŒŒì´í”„ë¼ì¸ì„ ì²´ê³„ì ì¸ ì›Œí¬í”Œë¡œìš°(Workflow)ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤. ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ë•Œ ì²˜ë¦¬ë˜ëŠ” ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

1.  **API ì§„ì… (Entry Point)**:
    *   ì‚¬ìš©ìê°€ APIë¡œ URLì„ ì „ì†¡í•˜ë©´ FastAPIê°€ ì´ë¥¼ ë°›ì•„ LangGraph ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.

2.  **ë…¸ë“œ 1: Fetch (Playwright)**:
    *   ì¼ë°˜ì ì¸ `requests` ëŒ€ì‹  ì‹¤ì œ ë¸Œë¼ìš°ì € ì—”ì§„ì¸ **Playwright**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
    *   ì•„ë§ˆì¡´ì˜ ë´‡ íƒì§€(Bot Detection) ë° CAPTCHAë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•´ í—¤ë”ë¥¼ ì¡°ì‘í•˜ê³ , ë™ì  ì½˜í…ì¸  ë¡œë”©(Lazy Loading)ì„ ìœ„í•´ ìŠ¤í¬ë¡¤ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    *   ìµœì¢… ë Œë”ë§ëœ HTMLì„ í™•ë³´í•©ë‹ˆë‹¤.

3.  **ë…¸ë“œ 2: Parse (BeautifulSoup)**:
    *   ê±°ëŒ€ ì–¸ì–´ ëª¨ë¸(LLM)ì— ë³´ë‚´ê¸° ì „, ë¶ˆí•„ìš”í•œ íƒœê·¸(Script, Style, Advertising ë“±)ë¥¼ ì œê±°í•©ë‹ˆë‹¤.
    *   HTML í…ìŠ¤íŠ¸ë¥¼ ì •ì œí•˜ì—¬ í† í° ë¹„ìš©ì„ ìµœì†Œí™”í•©ë‹ˆë‹¤.

4.  **ë…¸ë“œ 3: Extract (AWS Bedrock + Claude)**:
    *   ì •ì œëœ í…ìŠ¤íŠ¸ë¥¼ **Claude 3 Haiku** ëª¨ë¸ì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.
    *   ê°€ì„±ë¹„ê°€ ê°€ì¥ ë›°ì–´ë‚œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ìš© íš¨ìœ¨ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
    *   Amazon í˜ì´ì§€ì˜ ë³µì¡í•œ êµ¬ì¡°(í‘œ, ë¶ˆë¦¿ í¬ì¸íŠ¸, ìˆ¨ê²¨ì§„ ì„¸ë¶€ ì •ë³´)ì—ì„œ í•„ìš”í•œ ë°ì´í„°ë§Œ ì •í™•íˆ ì¶”ì¶œí•˜ë„ë¡ ì„¤ê³„ëœ í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
    *   ê²°ê³¼ë¥¼ êµ¬ì¡°í™”ëœ JSON í˜•íƒœë¡œ ë°˜í™˜ë°›ìŠµë‹ˆë‹¤. (Pydantic ëª¨ë¸ ê²€ì¦ í¬í•¨)

5.  **ì‘ë‹µ ë°˜í™˜**:
    *   ìµœì¢…ì ìœ¼ë¡œ ê²€ì¦ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©ìì—ê²Œ ë°˜í™˜í•©ë‹ˆë‹¤.

## ğŸ› ï¸ íŒŒì¼ êµ¬ì¡° (File Structure)

```
/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py        # FastAPI ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì  ë° API ë¼ìš°í„°
â”‚   â”œâ”€â”€ graph.py       # LangGraph ì›Œí¬í”Œë¡œìš° ì •ì˜ (ë…¸ë“œ ì—°ê²°)
â”‚   â”œâ”€â”€ nodes.py       # ê° ë‹¨ê³„ë³„ ë¡œì§ (Fetch -> Parse -> Extract)
â”‚   â”œâ”€â”€ models.py      # ë°ì´í„° êµ¬ì¡° ì •ì˜ (Request/Response Pydantic ëª¨ë¸)
â”‚   â””â”€â”€ utils.py       # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”œâ”€â”€ run.py             # ì„œë²„ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ (Entry Point)
â”œâ”€â”€ pyproject.toml     # í”„ë¡œì íŠ¸ ì„¤ì • ë° ì˜ì¡´ì„± (uvìš©)
â””â”€â”€ README.md          # ë¬¸ì„œ
```
